from locust import HttpLocust, TaskSet
import random

# http://localhost:8501
def predict(l):
    payload = {"signature_name": "serving_default", "instances": [[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 167, 214, 23, 13, 34, 20, 1, 347, 2155, 168, 1, 5553, 10873, 233, 6, 33, 1846, 4390, 38, 29, 93, 2, 93, 12, 50, 1264, 310, 5787, 220, 960, 40, 34, 268, 30, 1, 659, 5, 495, 3526, 2, 16, 10428, 299, 20, 32, 771, 233, 141, 419, 16, 10428, 22, 159, 1, 64, 1140, 7, 419, 69, 9845, 1, 771, 792, 11, 2792, 68, 491, 792, 364, 1, 192, 93, 11, 679, 25, 67, 7, 689, 2, 4816, 58, 257, 2, 4, 12675, 7, 38, 64, 2, 74, 23, 598, 52, 3936, 597, 357, 7, 65, 64, 2, 179, 1, 218, 2, 1, 1643, 76, 2, 16, 459, 9, 452, 290, 308, 20, 11, 7, 2441, 1, 75, 301, 6, 14, 294, 44, 5553, 5, 7, 65, 391, 2, 16, 1, 76, 40, 60, 52, 357, 240, 50, 40, 3121, 1, 150, 168, 5, 7, 86, 18, 4, 251, 2382, 3210, 6, 706, 12, 55, 103, 7269, 214, 870, 296, 3, 1339, 279, 1846, 910, 6279, 4592, 10079, 469, 1834, 5553, 469, 900, 307, 233, 1785, 3574, 947, 1435, 4302, 168, 2688, 20, 947, 1435, 2604, 7728, 1515, 344, 3769, 1520, 353, 352, 1045, 95, 299, 3464, 1045, 95, 190, 1520, 1045, 95, 140, 10134, 1520, 1045, 95, 140, 1520, 141, 299, 288, 556, 95, 299, 556, 1520, 1045, 95, 299, 533, 1520, 6363, 6728, 28, 2631, 95, 190, 12152, 1520, 1609, 95, 190, 95, 299, 261, 4932, 95, 299, 767, 6363, 8758, 95, 299, 6728, 767, 6363, 2241, 3204, 95, 299, 1379, 1520, 95, 140, 141, 162, 141, 152, 870, 6311, 10629, 103, 176, 2719, 13582, 1981, 16176, 380, 1574, 28, 9575, 1938, 439, 1574, 28, 8799, 1981, 4204]]}
    r = l.client.post("/v1/models/news:predict", json=payload)

class UserBehavior(TaskSet):
    tasks = {predict: 5}

    def on_start(self):
        print('start')

    def on_stop(self):
        print('stop')

class WebsiteUser(HttpLocust):
    task_set = UserBehavior
    # exponentially distributed wait time with average of 1 second
    wait_function = lambda self: random.expovariate(1)*1000